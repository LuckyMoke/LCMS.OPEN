<template "ui/head" />
<form class="layui-form layui-form-pane" action="{{$_L['url']['own_form']}}safe&action=save" method="post" target="_self">
    <ui form($form) />
</form>
<script type="text/javascript">
    let reLoginKey = function () {
        layer.confirm('确定生成？老的密钥会立即失效！', {
            btn: ['确定', '取消']
        }, function (index) {
            layer.close(index);
            LCMS.util.ajax({
                type: "GET",
                url: `${LCMS.url.own_form}safe&action=reloginkey`,
                loading: true,
                success: function (res) {
                    if (res.code == 1) {
                        let token = res.data;
                        token = JSON.stringify(token);
                        token = encodeURIComponent(token);
                        token = btoa(token);
                        layer.open({
                            type: 1,
                            title: "复制密钥添加到《网站登录器》中",
                            content: `<textarea style="box-sizing:border-box;width:calc(100% - 30px);height:270px;padding:10px;margin:0 15px 15px 15px;border:none">${token}</textarea>`,
                            btn: 0,
                            area: "500px",
                            end: function () {
                                LCMS.plugin.router(LCMS.url.now);
                            }
                        });
                    }
                }
            });
        });
    }
</script>
<template "ui/foot" />