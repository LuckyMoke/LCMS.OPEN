$(".lcms-form-upload-file-btn ._up").each(function(index){top.LCMSUIINDEX++;let up=$(this),id="LCMSUPLOADFILEBTN"+top.LCMSUIINDEX,mime=$(this).attr("data-mime"),accept=$(this).attr("data-accept"),local=$(this).attr("data-local"),ipt=$(this).parent(".lcms-form-upload-file-btn").siblings("input"),tpl='<input type="file" accept="'+(accept?accept:mime=="file"?"*":mime+"/*")+'" local="'+local+'" name="editorfile" style="position:absolute;left:0;top:0;width:100%;height:100%;opacity:0;cursor:pointer;font-size:0;">';up.attr("id",id);up.append(tpl);up.on("click","input",function(){let input=$(this);input.off("change").on("change",function(){up.children("._loading").css("display","inline-block");LCMS.plugin.upload.direct({type:"file",file:this.files[0],local:$(input).attr("local")>0?1:0,success:function(res){ipt.val(res.data.datasrc);LCMS.util.notify({content:res.msg})},complete:function(){up.children("._loading").hide();input.remove();up.append(tpl)},})})})});