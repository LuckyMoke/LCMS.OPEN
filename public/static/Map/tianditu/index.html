<!DOCTYPE html><html><head><title>天地图</title><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><style type="text/css">body,html{width:100%;height:100%;margin:0;padding:0;overflow:hidden}#Map{width:100%;height:100%;border:#ccc solid 1px;box-sizing:border-box}.tdt-infowindow-content{font-size:14px;line-height:24px!important}</style></head><body><div id="Map"></div><script type="text/javascript">let loadScript=function(url,callback){var script=document.createElement('script');script.type='text/javascript';if(script.readyState){script.onreadystatechange=function(){if('loaded'===script.readyState||'complete'===script.readyState){script.onreadystatechange=null;callback()}}}else{script.onload=function(){callback()}}script.src=url;document.getElementsByTagName('head')[0].appendChild(script)},initMap=function(){let map,marker,control,getParam=function(name){return location.href.match(new RegExp("[?#&]"+name+"=([^?#&]+)","i"))?RegExp.$1:""},zoom=(getParam("center").split(","),getParam("zoom")),markers=getParam("markers").split(","),info=decodeURIComponent(getParam("info")),zlist={18:0.0004,17:0.0007,16:0.0015,15:0.0027,14:0.0056,13:0.013,12:0.025,11:0.05,10:0.1,9:0.2,8:0.4,7:0.8,6:1.5,5:3,4:6,3:12,2:20,1:35};map=new T.Map("Map");map.centerAndZoom(new T.LngLat(markers[0],1*markers[1]+zlist[zoom]),zoom);control=new T.Control.Zoom;control.setPosition(T_ANCHOR_BOTTOM_RIGHT);map.addControl(control);map.addControl(new T.Control.Scale);map.addControl(new T.Control.MapType);marker=new T.Marker(new T.LngLat(markers[0],markers[1]));map.addOverLay(marker);info&&marker.openInfoWindow(new T.InfoWindow(info,{autoPan:true,closeButton:false}))};(async()=>{let res=await fetch(`${location.origin}/app/index.php?n=system&c=map`).then((response=>{if(!response.ok){alert(`地图加载失败：${response.statusText}`)}return response.json()})).then((data=>data)).catch((error=>{alert(`地图加载失败：${error}`)}));if(1==res.code){loadScript(`https://api.tianditu.gov.cn/api?v=4.0&tk=${res.data}`,(()=>{initMap()}))}else{alert(`地图加载失败`)}})();</script></body></html>